<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoinGecko API í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: monospace;
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            background: #334155;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            border: 1px solid #475569;
        }
        .test-section h2 {
            color: #60a5fa;
            margin-top: 0;
        }
        .success {
            color: #22c55e;
        }
        .error {
            color: #ef4444;
        }
        .loading {
            color: #fbbf24;
        }
        pre {
            background: #1e293b;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background: #2563eb;
        }
        .info-box {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 16px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª CoinGecko API í…ŒìŠ¤íŠ¸</h1>

    <div class="info-box">
        <strong>ğŸ“Œ í…ŒìŠ¤íŠ¸ ëª©ì :</strong> CoinGecko APIê°€ API í‚¤ ì—†ì´ ì‘ë™í•˜ëŠ”ì§€, ì–´ë–¤ ë°ì´í„°ë¥¼ ì œê³µí•˜ëŠ”ì§€ í™•ì¸
    </div>

    <!-- 1. ê¸°ë³¸ ê°€ê²© ì •ë³´ -->
    <div class="test-section">
        <h2>1ï¸âƒ£ ê°„ë‹¨í•œ ê°€ê²© ì •ë³´ (/simple/price)</h2>
        <p>ì—¬ëŸ¬ ì½”ì¸ì˜ í˜„ì¬ ê°€ê²©, ì‹œê°€ì´ì•¡, 24ì‹œê°„ ê±°ë˜ëŸ‰ ì¡°íšŒ</p>
        <button onclick="testSimplePrice()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        <div id="simple-price-result" class="loading">í…ŒìŠ¤íŠ¸ ëŒ€ê¸° ì¤‘...</div>
        <pre id="simple-price-data"></pre>
    </div>

    <!-- 2. ìƒì„¸ ì½”ì¸ ì •ë³´ -->
    <div class="test-section">
        <h2>2ï¸âƒ£ ë¹„íŠ¸ì½”ì¸ ìƒì„¸ ì •ë³´ (/coins/bitcoin)</h2>
        <p>ì‹œê°€ì´ì•¡, ê±°ë˜ëŸ‰, ì»¤ë®¤ë‹ˆí‹° ë°ì´í„°, ê°œë°œì ë°ì´í„° ë“±</p>
        <button onclick="testCoinDetail()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        <div id="coin-detail-result" class="loading">í…ŒìŠ¤íŠ¸ ëŒ€ê¸° ì¤‘...</div>
        <pre id="coin-detail-data"></pre>
    </div>

    <!-- 3. ì‹œì¥ ì°¨íŠ¸ ë°ì´í„° -->
    <div class="test-section">
        <h2>3ï¸âƒ£ ì‹œì¥ ì°¨íŠ¸ ë°ì´í„° (/coins/bitcoin/market_chart)</h2>
        <p>ê°€ê²©, ì‹œê°€ì´ì•¡, ê±°ë˜ëŸ‰ ì‹œê³„ì—´ ë°ì´í„° (ìµœê·¼ 7ì¼)</p>
        <button onclick="testMarketChart()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        <div id="market-chart-result" class="loading">í…ŒìŠ¤íŠ¸ ëŒ€ê¸° ì¤‘...</div>
        <pre id="market-chart-data"></pre>
    </div>

    <!-- 4. ì‹œì¥ ë°ì´í„° (ì—¬ëŸ¬ ì½”ì¸) -->
    <div class="test-section">
        <h2>4ï¸âƒ£ ì‹œì¥ ë°ì´í„° - ìƒìœ„ 10ê°œ ì½”ì¸ (/coins/markets)</h2>
        <p>ê°€ê²©, ë³€ë™ë¥ , ì‹œê°€ì´ì•¡, ê±°ë˜ëŸ‰ ë“± (ì •ë ¬ ê°€ëŠ¥)</p>
        <button onclick="testCoinsMarkets()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        <div id="coins-markets-result" class="loading">í…ŒìŠ¤íŠ¸ ëŒ€ê¸° ì¤‘...</div>
        <pre id="coins-markets-data"></pre>
    </div>

    <!-- 5. íŠ¸ë Œë”© ì½”ì¸ -->
    <div class="test-section">
        <h2>5ï¸âƒ£ íŠ¸ë Œë”© ì½”ì¸ (/search/trending)</h2>
        <p>ì§€ê¸ˆ ê°€ì¥ ì¸ê¸° ìˆëŠ” ì½”ì¸ë“¤ (ê²€ìƒ‰ëŸ‰ ê¸°ì¤€)</p>
        <button onclick="testTrending()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        <div id="trending-result" class="loading">í…ŒìŠ¤íŠ¸ ëŒ€ê¸° ì¤‘...</div>
        <pre id="trending-data"></pre>
    </div>

    <!-- 6. ê¸€ë¡œë²Œ ë°ì´í„° -->
    <div class="test-section">
        <h2>6ï¸âƒ£ ê¸€ë¡œë²Œ ì•”í˜¸í™”í ë°ì´í„° (/global)</h2>
        <p>ì „ì²´ ì‹œì¥ ì‹œê°€ì´ì•¡, ë¹„íŠ¸ì½”ì¸ ë„ë¯¸ë„ŒìŠ¤ ë“±</p>
        <button onclick="testGlobal()">í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        <div id="global-result" class="loading">í…ŒìŠ¤íŠ¸ ëŒ€ê¸° ì¤‘...</div>
        <pre id="global-data"></pre>
    </div>

    <script>
        const BASE_URL = 'https://api.coingecko.com/api/v3';

        // 1. ê°„ë‹¨í•œ ê°€ê²© ì •ë³´
        async function testSimplePrice() {
            const resultEl = document.getElementById('simple-price-result');
            const dataEl = document.getElementById('simple-price-data');

            resultEl.className = 'loading';
            resultEl.textContent = 'â³ API í˜¸ì¶œ ì¤‘...';
            dataEl.textContent = '';

            try {
                const response = await fetch(
                    `${BASE_URL}/simple/price?ids=bitcoin,ethereum&vs_currencies=krw,usd&include_market_cap=true&include_24hr_vol=true&include_24hr_change=true`
                );

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();

                resultEl.className = 'success';
                resultEl.innerHTML = `âœ… ì„±ê³µ! BTC: â‚©${data.bitcoin.krw.toLocaleString()} | ETH: â‚©${data.ethereum.krw.toLocaleString()}`;
                dataEl.textContent = JSON.stringify(data, null, 2);

            } catch (error) {
                resultEl.className = 'error';
                resultEl.textContent = `âŒ ì‹¤íŒ¨: ${error.message}`;
                dataEl.textContent = error.stack;
            }
        }

        // 2. ë¹„íŠ¸ì½”ì¸ ìƒì„¸ ì •ë³´
        async function testCoinDetail() {
            const resultEl = document.getElementById('coin-detail-result');
            const dataEl = document.getElementById('coin-detail-data');

            resultEl.className = 'loading';
            resultEl.textContent = 'â³ API í˜¸ì¶œ ì¤‘...';
            dataEl.textContent = '';

            try {
                const response = await fetch(
                    `${BASE_URL}/coins/bitcoin?localization=false&tickers=false&market_data=true&community_data=true&developer_data=true&sparkline=false`
                );

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();

                resultEl.className = 'success';
                resultEl.innerHTML = `âœ… ì„±ê³µ! ì‹œê°€ì´ì•¡: $${(data.market_data.market_cap.usd / 1e9).toFixed(2)}B | 24h ê±°ë˜ëŸ‰: $${(data.market_data.total_volume.usd / 1e9).toFixed(2)}B`;

                // ì¤‘ìš”í•œ ë°ì´í„°ë§Œ ì¶”ì¶œí•´ì„œ í‘œì‹œ
                const summary = {
                    name: data.name,
                    symbol: data.symbol,
                    current_price_krw: data.market_data.current_price.krw,
                    market_cap_rank: data.market_cap_rank,
                    market_cap_usd: data.market_data.market_cap.usd,
                    total_volume_usd: data.market_data.total_volume.usd,
                    price_change_24h: data.market_data.price_change_percentage_24h,
                    circulating_supply: data.market_data.circulating_supply,
                    total_supply: data.market_data.total_supply,
                    ath_krw: data.market_data.ath.krw,
                    ath_date: data.market_data.ath_date.krw,
                    community_data: data.community_data,
                    developer_data: {
                        forks: data.developer_data.forks,
                        stars: data.developer_data.stars,
                        subscribers: data.developer_data.subscribers,
                        total_issues: data.developer_data.total_issues
                    }
                };

                dataEl.textContent = JSON.stringify(summary, null, 2);

            } catch (error) {
                resultEl.className = 'error';
                resultEl.textContent = `âŒ ì‹¤íŒ¨: ${error.message}`;
                dataEl.textContent = error.stack;
            }
        }

        // 3. ì‹œì¥ ì°¨íŠ¸ ë°ì´í„°
        async function testMarketChart() {
            const resultEl = document.getElementById('market-chart-result');
            const dataEl = document.getElementById('market-chart-data');

            resultEl.className = 'loading';
            resultEl.textContent = 'â³ API í˜¸ì¶œ ì¤‘...';
            dataEl.textContent = '';

            try {
                const response = await fetch(
                    `${BASE_URL}/coins/bitcoin/market_chart?vs_currency=krw&days=7&interval=daily`
                );

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();

                resultEl.className = 'success';
                resultEl.innerHTML = `âœ… ì„±ê³µ! ê°€ê²© ë°ì´í„°: ${data.prices.length}ê°œ | ê±°ë˜ëŸ‰ ë°ì´í„°: ${data.total_volumes.length}ê°œ`;

                // ìš”ì•½ëœ ë°ì´í„°ë§Œ í‘œì‹œ
                const summary = {
                    prices_count: data.prices.length,
                    first_price: data.prices[0],
                    last_price: data.prices[data.prices.length - 1],
                    volumes_count: data.total_volumes.length,
                    sample_prices: data.prices.slice(0, 3),
                    sample_volumes: data.total_volumes.slice(0, 3)
                };

                dataEl.textContent = JSON.stringify(summary, null, 2);

            } catch (error) {
                resultEl.className = 'error';
                resultEl.textContent = `âŒ ì‹¤íŒ¨: ${error.message}`;
                dataEl.textContent = error.stack;
            }
        }

        // 4. ì‹œì¥ ë°ì´í„° (ì—¬ëŸ¬ ì½”ì¸)
        async function testCoinsMarkets() {
            const resultEl = document.getElementById('coins-markets-result');
            const dataEl = document.getElementById('coins-markets-data');

            resultEl.className = 'loading';
            resultEl.textContent = 'â³ API í˜¸ì¶œ ì¤‘...';
            dataEl.textContent = '';

            try {
                const response = await fetch(
                    `${BASE_URL}/coins/markets?vs_currency=krw&order=market_cap_desc&per_page=10&page=1&sparkline=false&price_change_percentage=24h`
                );

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();

                resultEl.className = 'success';
                resultEl.innerHTML = `âœ… ì„±ê³µ! ìƒìœ„ ${data.length}ê°œ ì½”ì¸ ë°ì´í„° ìˆ˜ì‹ `;

                // ê° ì½”ì¸ì˜ ì£¼ìš” ì •ë³´ë§Œ ì¶”ì¶œ
                const summary = data.map(coin => ({
                    rank: coin.market_cap_rank,
                    name: coin.name,
                    symbol: coin.symbol,
                    current_price: coin.current_price,
                    price_change_24h: coin.price_change_percentage_24h,
                    market_cap: coin.market_cap,
                    total_volume: coin.total_volume
                }));

                dataEl.textContent = JSON.stringify(summary, null, 2);

            } catch (error) {
                resultEl.className = 'error';
                resultEl.textContent = `âŒ ì‹¤íŒ¨: ${error.message}`;
                dataEl.textContent = error.stack;
            }
        }

        // 5. íŠ¸ë Œë”© ì½”ì¸
        async function testTrending() {
            const resultEl = document.getElementById('trending-result');
            const dataEl = document.getElementById('trending-data');

            resultEl.className = 'loading';
            resultEl.textContent = 'â³ API í˜¸ì¶œ ì¤‘...';
            dataEl.textContent = '';

            try {
                const response = await fetch(`${BASE_URL}/search/trending`);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();

                resultEl.className = 'success';
                resultEl.innerHTML = `âœ… ì„±ê³µ! íŠ¸ë Œë”© ì½”ì¸ ${data.coins.length}ê°œ ë°œê²¬`;

                // íŠ¸ë Œë”© ì½”ì¸ ì •ë³´ ì¶”ì¶œ
                const summary = {
                    coins: data.coins.map(item => ({
                        rank: item.item.market_cap_rank,
                        name: item.item.name,
                        symbol: item.item.symbol,
                        price_btc: item.item.price_btc
                    }))
                };

                dataEl.textContent = JSON.stringify(summary, null, 2);

            } catch (error) {
                resultEl.className = 'error';
                resultEl.textContent = `âŒ ì‹¤íŒ¨: ${error.message}`;
                dataEl.textContent = error.stack;
            }
        }

        // 6. ê¸€ë¡œë²Œ ë°ì´í„°
        async function testGlobal() {
            const resultEl = document.getElementById('global-result');
            const dataEl = document.getElementById('global-data');

            resultEl.className = 'loading';
            resultEl.textContent = 'â³ API í˜¸ì¶œ ì¤‘...';
            dataEl.textContent = '';

            try {
                const response = await fetch(`${BASE_URL}/global`);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }

                const data = await response.json();

                resultEl.className = 'success';
                resultEl.innerHTML = `âœ… ì„±ê³µ! ì „ì²´ ì‹œê°€ì´ì•¡: $${(data.data.total_market_cap.usd / 1e12).toFixed(2)}T | BTC ë„ë¯¸ë„ŒìŠ¤: ${data.data.market_cap_percentage.btc.toFixed(1)}%`;

                dataEl.textContent = JSON.stringify(data.data, null, 2);

            } catch (error) {
                resultEl.className = 'error';
                resultEl.textContent = `âŒ ì‹¤íŒ¨: ${error.message}`;
                dataEl.textContent = error.stack;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì²« ë²ˆì§¸ í…ŒìŠ¤íŠ¸ ìë™ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ§ª CoinGecko API í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ì¤€ë¹„ ì™„ë£Œ');
            testSimplePrice(); // ìë™ ì‹¤í–‰
        });
    </script>
</body>
</html>
